"use strict";const{app:t,BrowserWindow:s,ipcMain:l}=require("electron"),n=require("path"),c=require("fs"),a=require("xlsx");require("electron-squirrel-startup")&&t.quit();function d(e){const r=t.isPackaged?process.resourcesPath:n.resolve(__dirname,"..","..");return n.join(r,e)}async function i(){await new s({width:1200,height:800,webPreferences:{preload:n.join(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1}}).loadFile(n.join(__dirname,"../renderer/main_window/index.html"))}l.handle("load-approved-serials",async()=>{try{const e=d("input/batchall_report.xlsx"),r=c.readFileSync(e),o=a.read(r,{type:"buffer"}),u=o.SheetNames[0];return a.utils.sheet_to_json(o.Sheets[u],{header:1}).slice(1).map(p=>String(p[0]).trim()).filter(Boolean)}catch(e){return console.error("Error loading Excel:",e),[]}});l.handle("load-output-template",async()=>{const e=d("input/outputTemplate.xlsx");return c.readFileSync(e)});t.whenReady().then(()=>{i(),t.on("activate",()=>{s.getAllWindows().length===0&&i()})});t.on("window-all-closed",()=>{process.platform!=="darwin"&&t.quit()});
